(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[372],{3905:(e,t,a)=>{"use strict";a.d(t,{Zo:()=>d,kt:()=>u});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),s=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},d=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),m=s(a),u=r,k=m["".concat(p,".").concat(u)]||m[u]||c[u]||i;return a?n.createElement(k,l(l({ref:t},d),{},{components:a})):n.createElement(k,l({ref:t},d))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=m;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var s=2;s<i;s++)l[s]=a[s];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},58762:(e,t,a)=>{"use strict";a.r(t),a.d(t,{frontMatter:()=>i,metadata:()=>l,toc:()=>o,default:()=>s});var n=a(22122),r=(a(67294),a(3905));const i={title:"Caveats"},l={unversionedId:"caveats",id:"caveats",isDocsHomePage:!1,title:"Caveats",description:"Feature support",source:"@site/docs/caveats.md",sourceDirName:".",slug:"/caveats",permalink:"/TypeScriptToLua.github.io/docs/caveats",editUrl:"https://github.com/TypeScriptToLua/TypeScriptToLua.github.io/edit/source/docs/caveats.md",version:"current",frontMatter:{title:"Caveats"},sidebar:"docs",previous:{title:"Configuration",permalink:"/TypeScriptToLua.github.io/docs/configuration"},next:{title:"The Self Parameter",permalink:"/TypeScriptToLua.github.io/docs/the-self-parameter"}},o=[{value:"Feature support",id:"feature-support",children:[]},{value:"Differences from JavaScript",id:"differences-from-javascript",children:[{value:"Type-directed emit",id:"type-directed-emit",children:[]},{value:"Boolean coercion",id:"boolean-coercion",children:[]},{value:"Loose equality",id:"loose-equality",children:[]},{value:"Array Length",id:"array-length",children:[]},{value:"Key Iteration Order",id:"key-iteration-order",children:[]},{value:"Iterating an array with <code>for ... in</code>",id:"iterating-an-array-with-for--in",children:[]}]}],p={toc:o};function s({components:e,...t}){return(0,r.kt)("wrapper",(0,n.Z)({},p,t,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"feature-support"},"Feature support"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Feature"),(0,r.kt)("th",{parentName:"tr",align:"center"},"Lua 5.1"),(0,r.kt)("th",{parentName:"tr",align:"center"},"Lua 5.2"),(0,r.kt)("th",{parentName:"tr",align:"center"},"Lua 5.3"),(0,r.kt)("th",{parentName:"tr",align:"center"},"LuaJIT"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://github.com/TypeScriptToLua/TypeScriptToLua/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc+label%3A%22missing+feature%22"},"Missing features")),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Bitwise_Operators"},"Bitwise operators")),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/switch"},"Switch statement")),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/continue"},(0,r.kt)("inlineCode",{parentName:"a"},"continue"))),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u274c"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"(everything else)"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f"),(0,r.kt)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f")))),(0,r.kt)("h2",{id:"differences-from-javascript"},"Differences from JavaScript"),(0,r.kt)("p",null,"This project aims for both compilation results to have the same behavior as much as possible, but not at all costs. Since TypeScript is based on JavaScript it also inherited some of the quirks in JavaScript that are not present in Lua. This is where behavior between Lua and JavaScript compilation targets diverge. TypeScriptToLua aims to keep identical behavior as long as ",(0,r.kt)("strong",{parentName:"p"},"sane")," TypeScript is used: if JavaScript-specific quirks are used behavior might differ."),(0,r.kt)("p",null,"Below are some of the cases where resulting Lua intentionally behaves different from compiled JS."),(0,r.kt)("h3",{id:"type-directed-emit"},"Type-directed emit"),(0,r.kt)("p",null,"One of TypeScript's ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/microsoft/TypeScript/wiki/TypeScript-Design-Goals"},"design goals")," is ",(0,r.kt)("strong",{parentName:"p"},"not")," using type information to affect program runtime behavior. Though this has many advantages (such as gradual typing), TypeScriptToLua uses type information extensively. This allows us to emit a much more optimized, portable, and correct Lua code."),(0,r.kt)("h3",{id:"boolean-coercion"},(0,r.kt)("a",{parentName:"h3",href:"https://developer.mozilla.org/en-US/docs/Glossary/Falsy"},"Boolean coercion")),(0,r.kt)("p",null,"JavaScript and Lua differ in what they evaluate to true/false. TypeScriptToLua adheres to the Lua evaluations."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"TypeScript"),(0,r.kt)("th",{parentName:"tr",align:null},(0,r.kt)("em",{parentName:"th"},"JavaScript behavior")),(0,r.kt)("th",{parentName:"tr",align:null},(0,r.kt)("em",{parentName:"th"},"Lua behavior")))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"undefined")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"null")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"NaN")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false")),(0,r.kt)("td",{parentName:"tr",align:null},"\u26a0\ufe0f",(0,r.kt)("inlineCode",{parentName:"td"},"true"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'""')),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false")),(0,r.kt)("td",{parentName:"tr",align:null},"\u26a0\ufe0f",(0,r.kt)("inlineCode",{parentName:"td"},"true"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"0")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"false")),(0,r.kt)("td",{parentName:"tr",align:null},"\u26a0\ufe0f",(0,r.kt)("inlineCode",{parentName:"td"},"true"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"(Everything else)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"true")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"true"))))),(0,r.kt)("h3",{id:"loose-equality"},(0,r.kt)("a",{parentName:"h3",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Equality_comparisons_and_sameness#Loose_equality_using"},"Loose equality")),(0,r.kt)("p",null,"TypeScriptToLua makes no difference between ",(0,r.kt)("inlineCode",{parentName:"p"},"==")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"===")," when compiling to Lua, treating all comparisons as strict (",(0,r.kt)("inlineCode",{parentName:"p"},"==="),")."),(0,r.kt)("h3",{id:"array-length"},"Array Length"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Array.prototype.length")," is translated to Lua's ",(0,r.kt)("inlineCode",{parentName:"p"},"#")," operator. Due to the way lists are implemented in Lua there can be differences between JavaScript's ",(0,r.kt)("inlineCode",{parentName:"p"},"list.length")," and Lua's ",(0,r.kt)("inlineCode",{parentName:"p"},"#list"),". The transpiler does not do anything to remedy these differences, so when working with lists, the transpiled Lua will use the standard Lua conventions. Generally speaking, the situation where these differences occur happen when adding/removing items to a list in a hacky way, or when setting list items to ",(0,r.kt)("inlineCode",{parentName:"p"},"undefined"),"/",(0,r.kt)("inlineCode",{parentName:"p"},"null"),"."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Examples:")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Safe (no difference):")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"const myList = [1, 2, 3];\nmyList.push(4);\nmyList.pop();\nmyList.splice(1, 1);\n// myList.length == 2\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Differences might occur:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"const myList = [1, 2, 3];\nmyList[1] = undefined;\n// myList.length == 1 (3 in JavaScript)\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"const myList = [1, 2, 3];\nmyList[4] = 5;\n// myList.length == 3 (5 in JavaScript)\n")),(0,r.kt)("h3",{id:"key-iteration-order"},"Key Iteration Order"),(0,r.kt)("p",null,"Even though iterating over object keys with ",(0,r.kt)("inlineCode",{parentName:"p"},"for ... in")," does not guarantee order in either JavaScript or Lua. Therefore, the iteration order in JavaScript is likely different from the order in Lua."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note:")," If a specific order is required, it is better to use ordered collections like lists instead."),(0,r.kt)("h3",{id:"iterating-an-array-with-for--in"},"Iterating an array with ",(0,r.kt)("inlineCode",{parentName:"h3"},"for ... in")),(0,r.kt)("p",null,"Not allowed."))}s.isMDXComponent=!0}}]);